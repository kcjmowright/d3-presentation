<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>D3 JS - KCJS Presentation</title>
  <meta name="viewport" content="width=1024">
<link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="styles/coderdeck-core.min.css" type="text/css">
  <link rel="stylesheet" id='style-theme-link' href="styles/coderdeck.css" type="text/css">
  <link rel="stylesheet" href="styles/inlet.css" type="text/css">
  <script src="lib/jquery.min.js"></script>
  <script src="lib/modernizr.js"></script>
</head>
<body class="deck-container">

<script type='text/coderdeck' id='coderdeck-default'>
  <html>
    <head>
      <style>
        svg {
          top: 0px;
          left: 0px;
          width: 650px;
          height: 650px;
          position: absolute;
        }
      </style>
      <script src="lib/d3.min.js">SCRIPTEND
      <script src="lib/jquery.min.js">SCRIPTEND
    </head>
    <body>
     CODE
    </body>
  </html>
</script>

<script type="text/coderdeck" id="svg-template">
  <html>
    <title>test</title>
    <style>
      CODE
    </style>
    <body>
      <svg x="0" y="0" width="500" height="500">
      </svg>
    </body>
  </html>
</script>

<article class="slide slide-subhead">
  <h1>D3</h1>
  <h2>D3 is Data Driven Documents - A way to create data visualizations.</h2>
</article>

<article class="slide slide-list">
  <h2>SVG</h2>

  <h3>Shapes</h3>
  <div class="collapsible">
    <!-- p>
    SVG coordinate system  0,0 in upper left, basically the y or vertical is flipped compared to the traditional mathematical cartesian coordinate system.<br />
    Many element attributes are also style attributes. Best practice is to use CSS.
    </p -->
    <ul>
      <li>Rectangles - &lt;rect x="0" y="0" width="100" height="200" /&gt;</li>
      <li>Circles - &lt;circle cx="100" cy="100" r="100" /&gt;</li>
      <li>Ellipsis - &lt;ellipse cx="100" cy="100" rh="100" rw="100" /&gt;</li>
      <li>Path - &lt;path d="..." /&gt;</li>
      <li>Grouping - &lt;g&gt; ... &lt;/g&gt;</li>
      <li>Use - &lt;use /&gt;  Performance issues.  Best to just inject string markup.</li>
    </ul>
  </div>

  <h3>Filters</h3>
  <div class="collapsible">
    <ul>
      <li>&lt;feBlend&gt; - filter for combining images</li>
      <li>&lt;feColorMatrix&gt; - filter for color transforms</li>
      <li>&lt;feGaussianBlur&gt;</li>
      <li>&lt;feImage&gt;</li>
      <li>&lt;feMerge&gt;</li>
      <li>&lt;feOffset&gt; - filter for drop shadows</li>
      <li>etc...</li>
    </ul>
  </div>

  <h3>Gradients</h3>
  <div class="collapsible">
    <ul>
      <li>Linear</li>
      <li>Radial</li>
    </ul>
  </div>
</article>

<article class="slide slide-list">

  <h2>Selections and DOM Manipulation</h2>

  <h3>Selections</h3>
  <div class="collapsible">
    <!-- p>Supports all CSS selectors.  Creates jQuery like selection.  Uses Sizzle.</p -->
    <ul>
      <li>select - Select the first match.</li>
      <li>selectAll - Select all matches.</li>
    </ul>
  </div>

  <h3>DOM Manipulation</h3>
  <div class="collapsible">
    <ul>
      <li>append - Appends an element as the last child into the last element in the chain.</li>
      <li>insert - Inserts an element as the first child into the last element in the chain.</li>
      <li>remove - Removes a selection(s)</li>
      <li>attr - Modifies or accesses attributes.  Single attribute or map of attributes.</li>
      <li>style - Apply style to a selection.  Best practice is to use CSS stylesheets.</li>
      <li>classed - Add or remove a CSS class.</li>
    </ul>
  </div>

</article>

<article class="slide slide-list">
  <h2>Rectangle</h2>

  <textarea class="coder-editor coder-editor-instant">
<svg class="svg-rect-sample">
  <rect x="0" y="0"
        width="50" height="100"
        style="fill: #FF0000"/>
</svg>
<script>
  var rect = d3.select('svg.svg-rect-sample')
    .append('rect');
  rect.attr({
    x: 100,
    y: 0,
    width: 50,
    height: 100,
    fill: '#000'
  });
</script>
  </textarea>
</article>

<article class="slide slide-list">
  <h2>Circle</h2>

  <textarea class="coder-editor coder-editor-instant">
<svg class="svg-circle-sample">
  <circle cx="50" cy="50"
          r="50"
          style="fill: #FF0000"/>
</svg>
<script>
  var circle = d3.select('svg.svg-circle-sample')
    .append('circle');

  circle.attr({
    cx: 200,
    cy: 50,
    r: 50,
    fill: '#000'
  });
</script>
  </textarea>
</article>

<article class="slide slide-list">
  <h2>Ellipse</h2>

  <textarea class="coder-editor coder-editor-instant">
<svg class="svg-ellipse-sample">
  <ellipse cx="100" cy="100"
          rx="100" ry="50"
          style="fill: #FF0000"/>
</svg>
<script>
  var ellipse = d3.select('svg.svg-ellipse-sample')
    .append('ellipse');
  ellipse.attr({
    cx: 300,
    cy: 300,
    rx: 50,
    ry: 100,
    fill: '#000'
  });
</script>
  </textarea>
</article>

<article class="slide slide-list">
  <h2>Scales, Domains and Ranges</h2>

  <div class="collapsible">
    <!-- p>Data needs to be transformed to fit within the given real estate or mapped to other values.  Define the domain and range of a data set.</p -->
    <ul>
      <li>linear - continuous input domain to a continuous output range</li>
      <li>ordinal - a discrete domain, such as a set of names or categories</li>
      <li>pow - exponential transform</li>
      <li>log - logarithmic transform</li>
      <li>time - time transform</li>
      <li>color Scales</li>
    </ul>
  </div>
  <textarea class="coder-editor coder-editor-instant">
<svg class="svg-path-sample"></svg>
<script>
  var width = 500, height = 400;
  var data = [0, 80, 20, 70, 80, 60, 20];
  var svg = d3.select('.svg-path-sample')
    .append('g')
    .attr('transform', 'translate(0, 0) scale(1)');
  // Ordinal scale - doing things in order.
  var x = d3.scale.ordinal()
    // domain (array of min max)
    .domain(d3.range(data.length))
    // output range with padding.
    .rangeBands([15, width], 0.5);
  var y = d3.scale.linear()
    // domain (array of min max)
    .domain(d3.extent(data))
    // output range, an array of values to return.
    .range([0, height]);
  // Line generator.
  var line = d3.svg.line()
    .interpolate("cardinal")
    .x(function(d, i) { return x(i); })
    .y(function(d) { return y(d); });

  svg.append('path')
    .attr('d', line(data))
    .style({
      fill: 'none',
      stroke: '#000'
    });
</script>
  </textarea>
</article>


<article class="slide slide-list">

  <h2>Joining Data and DOM</h2>
  <div>
    <div style="margin: 0 auto; width: 460px;">
      <svg width="460" height="250">
        <g transform="translate(20,10) scale(1.2)">
          <circle cx="100" cy="100"
                  r="100"
                  style="fill: none; stroke: #000"/>
          <circle cx="200" cy="100"
                  r="100"
                  style="fill: none; stroke: #F00"/>
          <text x="0" y="25">Data</text>
          <text x="25" y="100">Enter</text>
          <text x="125" y="100">Update</text>
          <text x="250" y="100">Exit</text>
          <text x="270" y="25" style="fill: none; stroke: #F00">DOM</text>
        </g>
      </svg>
    </div>
  </div>

  <textarea class="coder-editor coder-editor-instant">
<svg class="join-example"></svg>
<script>
  var height = 250, width = 500;
  var svg = d3.select("svg.join-example");
  var data = [ 301, 20, 30, 40, 14, 7, 80, 73, 55, 93, 234, 2340, 303];
  var scale = d3.scale.linear().domain(d3.extent(data)).range([0, height]);
  var g = svg.append('g').attr({ transform: "translate(113,17) scale(0.724598784)"});
  var circles = g.selectAll('circle')
    .data(data);

  circles.enter()
    .append('circle')
    .attr({
      cx: function(d, i) { return i * (width/data.length); },
      cy: function(d) { return height - scale(d); },
      r: 10,
      fill: '#2da0fe'
    });
  circles.exit().remove();
</script>
  </textarea>

</article>

<article class="slide slide-list">
  <h2>Events</h2>

  <textarea class="coder-editor coder-editor-instant">
    <svg id="events-example"></svg>
    <script>
    d3.select("svg#events-example").append("circle")
    .attr({
      cx: 100,
      cy: 100,
      r: 50,
      fill: "#00FF00"
    })
    .on('click', function(d) {
      d3.select(this).attr('fill', function(){
        return '#ff5500';
      });
    });
    </script>
  </textarea>
</article>

<article class="slide slide-list">
  <h2>Axis Generator</h2>
  <textarea class="coder-editor coder-editor-instant">
<svg class="axis"></svg>
<script>
  var svg = d3.select('svg.axis');
  var scale = d3.scale.linear()
    .domain([20, 12])
    .range([10, 200]);
  var axis = d3.svg.axis()
    .scale(scale)
    .orient('bottom')
    .ticks(3);
  var g = svg.append('g');

  axis(g);
  g.attr('transform', 'translate(50, 50)');
  g.selectAll('path')
    .style({ fill: 'none', stroke: '#000'});
  g.selectAll('line')
    .style({ stroke: '#000'});
</script>
  </textarea>

</article>

<article class="slide slide-list">
  <h2>Brush</h2>
  <textarea class="coder-editor coder-editor-instant">
<svg class="brush"></svg>
<script>
  var width = 500, height = 500;
  var svg = d3.select('svg.brush')
    .append('g')
    .attr('transform', 'translate(-30, 90)');
  var scale = d3.scale.linear()
    .domain([20, 89])
    .range([10, 468]);
  var brush = d3.svg.brush();

  brush.x(scale);
  brush.extent([21,29]);
  brush.on('brush', function(){
    console.log(brush.extent());
  });

  var g = svg.append("g");
  brush(g);

  g.attr('transform','translate(50, 100)');
  g.selectAll('rect').attr('height', 30);
  g.selectAll('.background').style({
    fill: '#4b9e9e',
    visibility: 'visible'
  });
  g.selectAll('.extent').style({
    fill: '#78c5c5',
    visibility: 'visibile'
  });
  g.selectAll('.resize rect').style({
    fill: '#276c86',
    visibility: 'visible'
  });
</script>
  </textarea>

</article>


<article class="slide slide-list">
  <h2>Transitions</h2>

  <h3>Timing</h3>
  <h3>Easing</h3>
  <div class="collapsable">
    <ul>
      <li>linear - the identity function, t.</li>
      <li>poly(k) - raises t to the specified power k (e.g., 3).</li>
      <li>quad - equivalent to poly(2).</li>
      <li>cubic - equivalent to poly(3).</li>
      <li>sin - applies the trigonometric function sin.</li>
      <li>exp - raises 2 to a power based on t.</li>
      <li>circle - the quarter circle.</li>
      <li>elastic(a, p) - simulates an elastic band; may extend slightly beyond 0 and 1.</li>
      <li>back(s) - simulates backing into a parking space.</li>
      <li>bounce - simulates a bouncy collision.</li>
    </ul>
  </div>


    <textarea class="coder-editor coder-editor-instant">
<svg class="transitions"></svg>
<script>
  d3.select("svg.transitions").append("circle")
    .attr({
      cx: 100,
      cy: 100,
      r: 50,
      fill: "#00FF00"
    })
    .on('click', function(d) {
      d3.select(this).transition().duration(1000).ease('linear')
        .attr({
          fill:function(){ return '#ff5500';},
          cx: 200
        });
    });
</script>
    </textarea>

</article>

<article class="slide slide-list">
  <h2>Putting it All Together - Reusable Chart Pattern</h2>
  <textarea class="coder-editor coder-editor-instant">
<svg class="reusable"></svg>
<script>
  (function() {
    var chart = BarChart();

    chart.data([1,100,20,70,40,10,200,170,80,90,100,5,25,2]);
    chart('svg.reusable');

    function BarChart() {
      var width = 500;
      var height = 500;
      var data = [];
      var fill = '#78c5c5';
      var exponent = 1;
      var translateX = 80;
      var translateY = 10;
      var scale = 0.8;
      var xScale = d3.scale.ordinal();
      var yScale = d3.scale.pow();
      var brushScale = d3.scale.linear();
      var axis;
      var axisScale = d3.scale.pow();
      var axisContainer;
      var barContainer;
      var easeFn = 'bounce';

      function chart(element) {
        var max = d3.max(data);

        xScale.domain(d3.range(data.length)).rangeBands([0, width], 0.25);
        yScale.exponent(exponent).domain([0, max]).range([0, height]);
        brushScale.domain(d3.range(data.length)).range([0, width]);
        axisScale.exponent(exponent).domain([0, max]).range([height, 0]);
        axis = d3.svg.axis().scale(axisScale).orient('left').ticks(6);
        barContainer = d3.select(element).append('g').attr({
          transform: 'translate(' + translateX + ',' + translateY + ') scale(' + scale + ')'
        }).classed('bar-container', true);
        axisContainer = d3.select(element).append('g').classed('axis-container', true);

        var bars = barContainer.selectAll('rect').data(data);
        var brushContainer = d3.select(element).append("g").classed('brush-container', true);
        var brush = d3.svg.brush();

        brush.x(brushScale);
        brush.extent([0,1]);
        brush.on('brush', brushHandler);
        brush(brushContainer);

        brushContainer.attr('transform', 'translate(' + translateX + ', ' + (height - 30) + ') scale(' + scale + ')');
        brushContainer.selectAll('rect').attr('height', 30);
        brushContainer.selectAll('.background').style({
          fill: '#4b9e9e',
          visibility: 'visible'
        });
        brushContainer.selectAll('.extent').style({
          fill: fill,
          visibility: 'visibile'
        });
        brushContainer.selectAll('.resize rect').style({
          fill: '#276c86',
          visibility: 'visible'
        });

        axis(axisContainer);

        axisContainer.attr('transform', 'translate(' + translateX + ',' + translateY + ') scale(' + scale + ')');
        axisContainer.selectAll('path')
          .style({ fill: 'none', stroke: '#000'});
        axisContainer.selectAll('line')
          .style({ stroke: '#000'});

        bars.enter().append('rect');
        bars.attr({
          height: 0,
          fill: fill
        });
        bars.transition().delay(500).duration(750).ease(easeFn)
         .attr({
            x: function(d, i) { return xScale(i); },
            y: function(d) { return height - yScale(d); },
            width: xScale.rangeBand(),
            height: function(d) { return yScale(d); },
            fill: fill
          });
        bars.exit().remove();

        function brushHandler() {
          var extent = brush.extent();
          var startIdx = Math.floor(extent[0] * data.length);
          var endIdx = Math.floor(extent[1] * data.length);

          refresh(data.slice(startIdx, endIdx));
        }
      }

      function refresh(subset) {
        subset = subset || data;
        var max = d3.max(subset);
        var bars = barContainer.selectAll('rect').data(subset);

        xScale.domain(d3.range(subset.length));
        yScale.exponent(exponent).domain([0, max]);
        axisScale.exponent(exponent).domain([0, max]);
        axis(axisContainer);
        bars.enter().append('rect');
        bars.attr({
          x: function(d, i) { return xScale(i); },
          y: function(d) { return height - yScale(d); },
          width: xScale.rangeBand(),
          height: function(d) { return yScale(d); },
          fill: fill
        });
        bars.exit().remove();

      }

      chart.fill = function(value) {
        if(!value) { return fill; }
        fill = value;
        return chart;
      };

      chart.data = function(value) {
        if (!value) { return data; }
        data = value;
        return chart;
      };

      chart.width = function(value) {
        if (!value) { return width; }
        width = value;
        return chart;
      };

      chart.height = function(value) {
        if (!value) { return height; }
        height = value;
        return chart;
      };

      chart.exponent = function(value) {
        if (!value) { return exponent; }
        exponent = value;
        return chart;
      };

      return chart;
    }
  })();
</script>

  </textarea>

</article>

<!-- article class="slide slide-list">
  <h2>Bar Chart</h2>
  <textarea class="coder-editor coder-editor-instant">
<svg class="bar-chart"></svg>
<script>
  d3.json('data/bar.json', function(error, res) {
    var width = 500, height = 500;
    var svg = d3.select('svg.bar-chart');
    var data = res.data;
    var max = d3.max(data);
    var xScale = d3.scale.ordinal()
      .domain(d3.range(data.length))
      .rangeBands([0, width], 0.25);
    var yScale = d3.scale.linear()
      .domain([0, max])
      .range([0, height]);
    var g = svg.append('g').attr({
      transform: 'translate(0,0)'
    });
    var bars = g.selectAll('rect').data(data);

    bars.enter().append('rect');
    bars.attr({
      x: function(d, i) {
        return xScale(i);
      },
      y: function(d) {
        return height - yScale(d);
      },
      width: xScale.rangeBand(),
      height: function(d) {
        return yScale(d);
      },
      fill: '#d6a000'
    })
      .on('mouseover', function(d) {
        var $this = d3.select(this);
        if($this.classed('hover')){
          return;
        }
        $this.classed('hover', true);
        var popover = d3.select('body')
          .selectAll('div.popover')
          .data([d]);

        popover.enter()
          .append('div')
          .classed('popover', true)
          .style({
            position: 'absolute',
            width: '25px',
            height: '25px',
            top: d3.event.pageY + 'px',
            left: d3.event.pageX + 'px'
          })
          .text(d);
      })
      .on('mousemove', function(d) {
        d3.select('body')
          .selectAll('div.popover')
          .style({
            position: 'absolute',
            width: '25px',
            height: '25px',
            top: d3.event.pageY + 'px',
            left: d3.event.pageX + 'px'
          });
      })
      .on('mouseout', function(d) {
        d3.select(this).classed('hover', false);
        d3.selectAll('div.popover').remove();
      });
    bars.exit().remove();
  });
</script>
  </textarea>
</article -->

<article class="slide slide-list">
  <h2>Layouts</h2>

  <ul>
    <li><a href="https://github.com/mbostock/d3/wiki/Bundle-Layout">Bundle</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Chord-Layout">Chord</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Cluster-Layout">Cluster</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Force-Layout">Force</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Hierarchy-Layout">Hierarchy</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Histogram-Layout">Histogram</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Pack-Layout">Pack</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Partition-Layout">Partition</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Pie-Layout">Pie</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Stack-Layout">Stack</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Tree-Layout">Tree</a></li>
    <li><a href="https://github.com/mbostock/d3/wiki/Treemap-Layout">Treemap</a></li>
  </ul>

</article>

<article class="slide slide-list">
  <h2>Pie Layout and Arc Generator</h2>
  <textarea class="coder-editor coder-editor-instant">
<svg class="pie-layout"></svg>
<script>
  (function() {
    var chart = PieChart();

    chart.url('data/pie.json');
    chart('svg.pie-layout');

    function PieChart() {
      var url;
      var width = 500;
      var height = 500;

      function chart(element) {
        d3.json('data/pie.json', function(error, pie){
          var data = pie.data;
          var radius = Math.min(width, height) / 2;
          var svg = d3.select(element)
            .append('g')
            .attr('transform', "translate(" + width / 2 + "," + height / 2 + ")");
          var color = d3.scale.ordinal()
            .range(["#98abc5", "#8a89a6", "#d0743c", "#ff8c00"]);
          var arc = d3.svg.arc()
            .outerRadius(radius - 12)
            .innerRadius(59);
          var labelArc = d3.svg.arc()
            .outerRadius(radius - 40)
            .innerRadius(radius - 125);
          var pie = d3.layout.pie()
            .value(function(d) {
              return d.value;
            });
          var g = svg.selectAll(".arc")
            .data(pie(data))
            .enter()
            .append("g")
            .attr({
              'class': 'arc',
              'stroke': '#ffffff'
            });

          g.append('path')
            .attr('d', arc)
            .style('fill', function(d) {
              return color(d.data.label);
            });
          g.append('text')
            .attr("transform", function(d) {
              return 'translate(' + labelArc.centroid(d) + ')';
            })
            .attr({
              dy: '.35em',
              fill: '#FFF',
              stroke: '#FFF'
            })
            .style('font-family', 'Arial, sans-serif')
            .text(function(d) {
              return d.data.label;
            });
        });
      }

      chart.url = function(value) {
        if(!value) {
          return url;
        }
        url = value;
        return chart;
      };

      chart.width = function(value) {
        if(!value) {
          return width;
        }
        width = value;
        return chart;
      };

      chart.height = function(value) {
        if(!value) {
          return height;
        }
        height = value;
        return chart;
      };

      return chart;
    }

  })();
</script>
  </textarea>

</article>

<article class="slide slide-list">
  <h2>Force Layout</h2>
  <textarea class="coder-editor coder-editor-instant">
<svg class="force"></svg>
<script>
  (function() {
    var chart = ForceViz();

    chart.url("data/miserables.json");
    chart("svg.force");

    function ForceViz() {
      var url;
      var width = 500;
      var height = 500;
      var color = d3.scale.category20();
      var alpha = 0.1;
      var charge = -120;
      var linkDistance = 30;

      function chart(element) {

        var force = d3.layout.force()
          .alpha(alpha)
          .charge(charge)
          .linkDistance(linkDistance)
          .size([width, height]);
        var svg = d3.select(element);

        d3.json(url, function(error, graph) {

          var link = svg.selectAll(".link")
            .data(graph.links)
            .enter()
            .append("line")
            .attr({
              "class": "link",
              "stroke-width": function(d) {
                return Math.sqrt(d.value);
              }
            });
          var node = svg.selectAll(".node")
            .data(graph.nodes)
            .enter()
            .append("circle")
            .attr({
              "class": "node",
              "r": 10,
              "fill": function(d) { return color(d.group); }
            })
            .call(force.drag);

          node.append("title")
            .text(function(d) { return d.name; });

          force
            .nodes(graph.nodes)
            .links(graph.links)
            .start()
            .on("tick", function() {
              link.attr("x1", function(d) { return d.source.x; })
                .attr("y1", function(d) { return d.source.y; })
                .attr("x2", function(d) { return d.target.x; })
                .attr("y2", function(d) { return d.target.y; });
              node.attr("cx", function(d) { return d.x; })
                .attr("cy", function(d) { return d.y; });
            });
        });
      }

      chart.url = function(value) {
        if(!value) {
          return url;
        }
        url = value;
        return chart;
      };

      chart.charge = function(value) {
        if(!value) {
          return charge;
        }
        charge = value;
        return chart;
      };

      chart.linkDistance = function(value) {
        if(!value) {
          return linkDistance;
        }
        linkDistance = value;
        return chart;
      };

      chart.alpha = function(value) {
        if(!value) {
          return alpha;
        }
        alpha = value;
        return chart;
      };

      return chart;
    };
  })();

</script>
<style>
  .node {
    stroke: #fff;
    stroke-width: 1.5px;
  }
  .link {
    stroke: #999;
    stroke-opacity: .6;
  }
</style>
  </textarea>

</article>

<article class="slide slide-list">
  <h2>Data Sources</h2>

  <h3>AJAX Methods to Retrieve Data</h3>
  <div class="collapsible">
    <!-- p>D3 is able to access a variety of AJAX type data sources.</p -->
    <ul>
      <li>json</li>
      <li>csv</li>
      <li>tsv</li>
      <li>xml</li>
    </ul>
    <pre>d3.json("my.json", function(error, json) {
      // do something.
    });</pre>
  </div>

  <h3>Public Data Sources</h3>
  <div class="collapsible">
    <!-- p>There are many publicly available and free data sources.</p -->
    <ul>
      <li>data.kcmo.gov</li>
      <li>data.mo.gov</li>
      <li>census.gov</li>
      <li>data.gov</li>
      <li>dev.twitter.com</li>
      <li>github</li>
      <li>bitcoin, coinbase</li>
    </ul>
  </div>
</article>

<article class="slide slide-list">
  <h2>Geo</h2>

  <h3>Get the Data</h3>
  <div class="collapsible">
    <!-- p>Many sites offer GeoJSON or other geo data formats.</p -->
    <ul>
      <li>
        <a href="http://www.census.gov/geo/maps-data/data/tiger-cart-boundary.html">
        http://www.census.gov/geo/maps-data/data/tiger-cart-boundary.html</a>
      </li>
      <li><a href="http://data.mo.gov">data.mo.gov</a></li>
      <li><a href="http://data.kcmo.gov">data.kcmo.gov</a></li>
    </ul>
  </div>

  <h3>Convert the Data to GeoJSON</h3>
  <div class="collapsible">
    <!-- p>D3 uses GeoJSON.   If the data is not in GeoJSON format, then convert it.</p -->
    <ul>
      <li><a href="http://geojson.org/geojson-spec.html">http://geojson.org/geojson-spec.html</a></li>
      <li><a href="http://converter.mygeodata.eu/vector">http://converter.mygeodata.eu/vector</a></li>
    </ul>
  </div>

  <h3>D3 Geo Basics</h3>
  <div class="collapsible">
    <p></p>
    <ul>
      <li>
        Create a projection
        <pre>var projection = d3.geo.mercator()
          .translate([w*10.25, h*5])
          .scale([3000]);</pre>
      </li>
      <li>
        Create a geo path generator.
        <pre>var path = d3.geo.path().projection(projection);</pre>
      </li>
      <li>
        Add color ( Create a chloropleth ) or plot points.
        <pre>var colorScale = d3.scale.linear()
          .range(['#fef0d9','#fdcc8a','#fc8d59','#e34a33','#b30000']);</pre>
      </li>
    </ul>
  </div>

</article>
<article class="slide slide-list">

  <h2>Geo Code Example</h2>
  <textarea class="coder-editor coder-editor-instant">
<span class="mopoptitle"></span>
<svg class="geo"></svg>
<script>
  (function() {
    var chart = GeoViz();

    chart.url("data/mo-counties.geo.json");
    chart("svg.geo");

    function GeoViz() {
      var url;
      var width = 500;
      var height = 500;
      var dataKeys = {
        "pop_1990": "MO Population 1990",
        "pop_2000": "MO Population 2000"
      };
      var dataKey = "pop_1990";
      var translateX = width*10.25;
      var translateY = height*5;
      var scale = 3000;

      function chart(element) {
// Projection
        var projection = d3.geo.mercator()
          .translate([translateX, translateY])
          .scale([scale]);
// Geo Path Generator
        var path = d3.geo.path().projection(projection);
        var g = d3.select(element)
          .attr({ width: width, height: height }).append('g');
// Get the data
        d3.json(url, function(error, json) {
          max = d3.max(json.features, function(d) {
            return d.properties[dataKey];
          });
// colorbrewer2.org Chloropleth
          var colorScale = d3.scale.linear()
            .range(['#fef0d9','#fdcc8a','#fc8d59','#e34a33','#b30000'])
            .domain([0, max]);
          var mopoptitle = d3.selectAll('.mopoptitle').text(dataKeys[dataKey]);
          var map = g.selectAll('path')
            .data(json.features)
            .enter()
            .append('path')
            .attr('d', path)
            .style('fill', fill)
            .on('click', nextKey);

          function fill(d) {
            var value = d.properties[dataKey];
            return value ? colorScale(value) : '#666';
          }

          function nextKey() {
            var keys = Object.getOwnPropertyNames(dataKeys);
            var idx = keys.findIndex(function(d) {
              return d === dataKey;
            });

            dataKey = keys[(++idx === keys.length) ? 0 : idx];
            max = d3.max(json.features, function(d) {
              return d.properties[dataKey];
            });
            colorScale.domain([0, max]);
            map.transition().style('fill', fill);
            mopoptitle.transition().text(dataKeys[dataKey]);
          }
        });
      }

      chart.url = function(value) {
        if(!value) {
          return url;
        }
        url = value;
        return chart;
      };

      return chart;
    }

  })();
</script>
  </textarea>

</article>

<article class="slide slide-list">
  <h2>References</h2>

  <h3>D3 References, Articles and Tools</h3>
  <div class="collapsible">
    <ul>
      <li><a href="https://github.com/kcjmowright/d3-presentation">https://github.com/kcjmowright/d3-presentation - Source to these slides</a></li>
      <li><a href="http://d3js.org" target="_blank">d3js.org</a></li>
      <li><a href="http://bl.ocks.org" target="_blank">bl.ocks.org</a> - Mike Bostock</li>
      <li><a href="http://bost.ocks.org/mike/chart" target="_blank">Mike Bostock's reusable chart pattern</a></li>
      <li><a href="http://bost.ocks.org/mike/join/" target="_blank">Thinking in Joins</a></li>
      <li><a href="http://tributary.io" target="_blank">tributary.io</a> - live editing for d3 and visualization similar to plunker, jsfiddle, binjs etc.</li>
      <li><a href="http://www.coppelia.io/2014/07/an-a-to-z-of-extra-features-for-the-d3-force-layout/" target="_blank">AN A TO Z OF EXTRA FEATURES FOR THE D3 FORCE LAYOUT/</a></li>
    </ul>
  </div>

  <h3>D3 Examples</h3>
  <div class="collapsible">
    <ul>
      <li><a href="http://nvd3.org/ghpages/examples.html" target="_blank">NVD</a></li>
      <li><a href="http://bost.ocks.org">Blocks - D3 Examples with code</a></li>
      <li><a href="http://bost.ocks.org/mike/example" target="_blank">Mike's Blocks Examples</a></li>
      <li><a href="http://exposedata.com">Kai Chang</a></li>
      <li><a href="http://biovisualize.github.io">D3 Visualization Gallery</a></li>
      <li><a href="http://map.norsecorp.com">Norsecorp</a></li>
    </ul>
  </div>

  <h3>Geo Resources</h3>
  <div class="collapsible">
    <ul>
      <li><a href="http://colorbrewer2.org">Color Brewer</a></li>
      <li><a href="http://exposedata.com/talk/d3-geo">http://exposedata.com/talk/d3-geo</a></li>
      <li><a href="http://halftone.co/projects/temperatures/">http://halftone.co/projects/temperatures/</a></li>
    </ul>
  </div>

  <h3>D3 Tutorials</h3>
  <div class="collapsible">
    <ul>
      <li><a href="http://enjalot.github.io/intro-d3/frontendmasters" target="_blank">Ian Johnsons - D3 Tutorial References</a></li>
    </ul>
  </div>

  <h3>SVG References</h3>
  <div class="collapsible">
    <ul>
      <li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element" target="_blank">MDN SVG elements</a></li>
      <li><a href="http://www.w3.org/TR/SVG/" target="_blank">W3C SVG Reference</a></li>
    </ul>
  </div>
</article>

<script src="lib/inlet.js"></script>
<script src="lib/coderdeck.js"></script>

<script>
  $(function() {
    $.deck('.slide');
    $('h3').css('cursor','pointer').bind('click', function() {
      var $target = $(this);
      var $p = $target.next();

      $p.toggle('hide');
    });

  });
</script>
</body>
</html>
